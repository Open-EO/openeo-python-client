<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Machine Learning &#8212; openEO Python Client 0.47.0a1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=ad3dbffd" />
    <script src="_static/documentation_options.js?v=8bea4455"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configuration" href="configuration.html" />
    <link rel="prev" title="DataCube construction" href="datacube_construction.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="machine-learning">
<h1>Machine Learning<a class="headerlink" href="#machine-learning" title="Link to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This API and documentation is experimental,
under heavy development and subject to change.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.10.0.</span></p>
</div>
<section id="random-forest-based-classification-and-regression">
<h2>Random Forest based Classification and Regression<a class="headerlink" href="#random-forest-based-classification-and-regression" title="Link to this heading">¶</a></h2>
<p>openEO defines a couple of processes for <em>random forest</em> based machine learning
for Earth Observation applications:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fit_class_random_forest</span></code> for training a random forest based classification model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fit_regr_random_forest</span></code> for training a random forest based regression model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_random_forest</span></code> for inference/prediction</p></li>
</ul>
<p>The openEO Python Client library provides the necessary functionality to set up
and execute training and inference workflows.</p>
<section id="training">
<h3>Training<a class="headerlink" href="#training" title="Link to this heading">¶</a></h3>
<p>Let’s focus on training a classification model, where we try to predict
a class like a land cover type or crop type based on predictors
we derive from EO data.
For example, assume we have a GeoJSON FeatureCollection
of sample points and a corresponding classification target value as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">feature_collection</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;b3dw-wd23&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">51.1</span><span class="p">]}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;r8dh-3jkd&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">51.2</span><span class="p">]}</span>
    <span class="p">},</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Confusingly, the concept “feature” has somewhat conflicting meanings
for different audiences. GIS/EO people use “feature” to refer to the “rows”
in this feature collection.
For the machine learning community however, the properties (the “columns”)
are the features.
To avoid confusion in this discussion we will avoid the term “feature”
and instead use “sample point” for the former and “predictor” for the latter.</p>
</div>
<p>We first build a datacube of “predictor” bands.
For simplicity, we will just use the raw B02/B03/B04 band values here
and use the temporal mean to eliminate the time dimension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cube</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">load_collection</span><span class="p">(</span>
    <span class="s2">&quot;SENTINEL2&quot;</span><span class="p">,</span>
    <span class="n">temporal_extent</span><span class="o">=</span><span class="p">[</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">],</span>
    <span class="n">spatial_extent</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;B02&quot;</span><span class="p">,</span> <span class="s2">&quot;B03&quot;</span><span class="p">,</span> <span class="s2">&quot;B04&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">cube</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">reduce_dimension</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We now use <code class="docutils literal notranslate"><span class="pre">aggregate_spatial</span></code> to sample this <em>raster data cube</em> at the sample points
and get a <em>vector cube</em> where we have the temporal mean of the B02/B03/B04 bands as predictor values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">predictors</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">aggregate_spatial</span><span class="p">(</span><span class="n">feature_collection</span><span class="p">,</span> <span class="n">reducer</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now train a <em>Random Forest</em> model by calling the
<a class="reference internal" href="api.html#openeo.rest.vectorcube.VectorCube.fit_class_random_forest" title="openeo.rest.vectorcube.VectorCube.fit_class_random_forest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_class_random_forest()</span></code></a> method on the predictor vector cube
and passing the original target class data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">predictors</span><span class="o">.</span><span class="n">fit_class_random_forest</span><span class="p">(</span>
    <span class="n">target</span><span class="o">=</span><span class="n">feature_collection</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Save the model as a batch job result asset</span>
<span class="c1"># so that we can load it in another job.</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">save_ml_model</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally execute this whole training flow as a batch job:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">training_job</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_job</span><span class="p">()</span>
<span class="n">training_job</span><span class="o">.</span><span class="n">start_and_wait</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="inference">
<h3>Inference<a class="headerlink" href="#inference" title="Link to this heading">¶</a></h3>
<p>When the batch job finishes successfully, the trained model can then be used
with the <code class="docutils literal notranslate"><span class="pre">predict_random_forest</span></code> process on the raster data cube
(or another cube with the same band structure) to classify all the pixels.</p>
<p>Technically, the openEO <code class="docutils literal notranslate"><span class="pre">predict_random_forest</span></code> process has to be used as a reducer function
inside a <code class="docutils literal notranslate"><span class="pre">reduce_dimension</span></code> call, but the openEO Python client library makes it
a bit easier by providing a <a class="reference internal" href="api.html#openeo.rest.datacube.DataCube.predict_random_forest" title="openeo.rest.datacube.DataCube.predict_random_forest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_random_forest()</span></code></a> method
directly on the <a class="reference internal" href="api.html#openeo.rest.datacube.DataCube" title="openeo.rest.datacube.DataCube"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataCube</span></code></a> class, so that you can just do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">predicted</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">predict_random_forest</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">training_job</span><span class="o">.</span><span class="n">job_id</span><span class="p">,</span>
    <span class="n">dimension</span><span class="o">=</span><span class="s2">&quot;bands&quot;</span>
<span class="p">)</span>

<span class="n">predicted</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;predicted.GTiff&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We specified the model here by batch job id (string),
but it can also be specified in other ways:
as <a class="reference internal" href="api.html#openeo.rest.job.BatchJob" title="openeo.rest.job.BatchJob"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchJob</span></code></a> instance,
as URL to the corresponding STAC Item that implements the <cite>ml-model</cite> extension,
or as <a class="reference internal" href="api.html#openeo.rest.mlmodel.MlModel" title="openeo.rest.mlmodel.MlModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MlModel</span></code></a> instance (e.g. loaded through
<a class="reference internal" href="api.html#openeo.rest.connection.Connection.load_ml_model" title="openeo.rest.connection.Connection.load_ml_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_ml_model()</span></code></a>).</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">openEO Python Client</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Open-EO&repo=openeo-python-client&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">openEO Python Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_access.html">Finding and loading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="processes.html">Working with processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_jobs.html">Batch Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="udp.html">User-Defined Processes (UDP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="auth.html">Authentication and Account Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="udf.html">User-Defined Functions (UDF) explained</a></li>
<li class="toctree-l1"><a class="reference internal" href="datacube_construction.html">DataCube construction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Machine Learning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#random-forest-based-classification-and-regression">Random Forest based Classification and Regression</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook/index.html">openEO CookBook</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API (General)</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-processes.html">API: <code class="docutils literal notranslate"><span class="pre">openeo.processes</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="api-artifacts.html">API: openeo.extra.artifacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="process_mapping.html">openEO Process Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="best_practices.html">Best practices, coding style and general tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="federation-extension.html">Federation extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="datacube_construction.html" title="previous chapter">DataCube construction</a></li>
      <li>Next: <a href="configuration.html" title="next chapter">Configuration</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><!-- Alabaster (krTheme++) Hacks -->

<div class="sidebar-meta">
<h3>Meta</h3>
<div>Docs for openEO Python Client</div>
<div>Version: <code>0.47.0a1</code></div>
<div>Last updated: 2025/11/01</div>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2017 - 2025, Jeroen Dries.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/machine_learning.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>